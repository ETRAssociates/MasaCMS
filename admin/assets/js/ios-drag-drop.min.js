/*! mobile-drag-drop 2.3.0-rc.0 | Copyright (c) 2018 Tim Ruffles | MIT License */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.MobileDragDrop=t.MobileDragDrop||{})}(this,function(t){"use strict";var e="dnd-poly-",i=["none","copy","copyLink","copyMove","link","linkMove","move","all"],n=["none","copy","move","link"],s=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}();function o(t){return t&&t.tagName}function r(t,e,i){void 0===i&&(i=!0),document.addEventListener(t,e,!!s&&{passive:i})}function h(t,e){document.removeEventListener(t,e)}function a(t,e,i,n){void 0===n&&(n=!1);var o=s?{passive:!0,capture:n}:n;return t.addEventListener(e,i,o),{off:function(){t.removeEventListener(e,i,o)}}}function d(t){return 0===t.length?0:t.reduce(function(t,e){return e+t},0)/t.length}function f(t,e){for(var i=0;i<t.changedTouches.length;i++)if(t.changedTouches[i].identifier===e)return!0;return!1}function u(t,e,i){for(var n=[],s=[],o=0;o<e.touches.length;o++){var r=e.touches[o];n.push(r[t+"X"]),s.push(r[t+"Y"])}i.x=d(n),i.y=d(s)}var c=["","-webkit-"];function l(t,e,i,n,s){void 0===s&&(s=!0);var o=e.x,r=e.y;n&&(o+=n.x,r+=n.y),s&&(o-=parseInt(t.offsetWidth,10)/2,r-=parseInt(t.offsetHeight,10)/2);for(var h="translate3d("+o+"px,"+r+"px, 0)",a=0;a<c.length;a++){var d=c[a]+"transform";t.style[d]=h+" "+i[a]}}var p=function(){function t(t,e){this.t=t,this.i=e,this.s=n[0]}return Object.defineProperty(t.prototype,"dropEffect",{get:function(){return this.s},set:function(t){0!==this.t.mode&&i.indexOf(t)>-1&&(this.s=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"types",{get:function(){if(0!==this.t.mode)return Object.freeze(this.t.types)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectAllowed",{get:function(){return this.t.effectAllowed},set:function(t){2===this.t.mode&&i.indexOf(t)>-1&&(this.t.effectAllowed=t)},enumerable:!0,configurable:!0}),t.prototype.setData=function(t,e){if(2===this.t.mode){if(t.indexOf(" ")>-1)throw new Error("illegal arg: type contains space");this.t.data[t]=e,-1===this.t.types.indexOf(t)&&this.t.types.push(t)}},t.prototype.getData=function(t){if(1===this.t.mode||2===this.t.mode)return this.t.data[t]||""},t.prototype.clearData=function(t){if(2===this.t.mode){if(t&&this.t.data[t]){delete this.t.data[t];var e=this.t.types.indexOf(t);return void(e>-1&&this.t.types.splice(e,1))}this.t.data={},this.t.types=[]}},t.prototype.setDragImage=function(t,e,i){2===this.t.mode&&this.i(t,e,i)},t}();function g(t,e){return t?t===i[0]?n[0]:0===t.indexOf(i[1])||t===i[7]?n[1]:0===t.indexOf(i[4])?n[3]:t===i[6]?n[2]:n[1]:3===e.nodeType&&"A"===e.tagName?n[3]:n[1]}function v(t,e,i,n,s,o,r){void 0===o&&(o=!0),void 0===r&&(r=null);var h=function(t,e,i,n,s,o,r){void 0===r&&(r=null);var h=e.changedTouches[0],a=new Event(i,{bubbles:!0,cancelable:n});a.dataTransfer=o,a.relatedTarget=r,a.screenX=h.screenX,a.screenY=h.screenY,a.clientX=h.clientX,a.clientY=h.clientY,a.pageX=h.pageX,a.pageY=h.pageY;var d=t.getBoundingClientRect();return a.offsetX=a.clientX-d.left,a.offsetY=a.clientY-d.top,a}(e,i,t,o,document.defaultView,s,r),a=!e.dispatchEvent(h);return n.mode=0,a}function m(t,e){if(!t||t===i[7])return e;if(e===n[1]){if(0===t.indexOf(n[1]))return n[1]}else if(e===n[3]){if(0===t.indexOf(n[3])||t.indexOf("Link")>-1)return n[3]}else if(e===n[2]&&(0===t.indexOf(n[2])||t.indexOf("Move")>-1))return n[2];return n[0]}var y,D=function(){function t(t,e,i,n){this.h=t,this.o=e,this.u=i,this.l=n,this.v=0,this.p=null,this.g=null,this.m=t,this.I=t.changedTouches[0],this.j=this.S.bind(this),this.k=this.A.bind(this),r("touchmove",this.j,!1),r("touchend",this.k,!1),r("touchcancel",this.k,!1)}return t.prototype.O=function(){var t=this;this.v=1,this.C=n[0],this.D={data:{},effectAllowed:void 0,mode:3,types:[]},this.M={x:null,y:null},this.F={x:null,y:null};var e=this.u;if(this.N=new p(this.D,function(i,n,s){e=i,"number"!=typeof n&&"number"!=typeof s||(t.P={x:n||0,y:s||0})}),this.D.mode=2,this.N.dropEffect=n[0],v("dragstart",this.u,this.m,this.D,this.N))return this.v=3,this.T(),!1;u("page",this.m,this.F);var i,s=this.o.dragImageSetup(e);if(this.L=(i=s,c.map(function(t){var e=i.style[t+"transform"];return e&&"none"!==e?e.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""})),s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.zIndex="999999",s.classList.add("dnd-poly-drag-image"),s.classList.add("dnd-poly-icon"),this._=s,!this.P)if(this.o.dragImageOffset)this.P={x:this.o.dragImageOffset.x,y:this.o.dragImageOffset.y};else if(this.o.dragImageCenterOnTouch){var o=getComputedStyle(e);this.P={x:0-parseInt(o.marginLeft,10),y:0-parseInt(o.marginTop,10)}}else{var r=e.getBoundingClientRect();o=getComputedStyle(e),this.P={x:r.left-this.I.clientX-parseInt(o.marginLeft,10)+r.width/2,y:r.top-this.I.clientY-parseInt(o.marginTop,10)+r.height/2}}return l(this._,this.F,this.L,this.P,this.o.dragImageCenterOnTouch),document.body.appendChild(this._),this.V=window.setInterval(function(){t.X||(t.X=!0,t.Y(),t.X=!1)},this.o.iterationInterval),!0},t.prototype.T=function(){this.V&&(clearInterval(this.V),this.V=null),h("touchmove",this.j),h("touchend",this.k),h("touchcancel",this.k),this._&&(this._.parentNode.removeChild(this._),this._=null),this.l(this.o,this.m,this.v)},t.prototype.S=function(t){var e=this;if(!1!==f(t,this.I.identifier)){if(this.m=t,0===this.v){var i=void 0;if(this.o.dragStartConditionOverride)try{i=this.o.dragStartConditionOverride(t)}catch(t){i=!1}else i=1===t.touches.length;return i?void(!0===this.O()&&(this.h.preventDefault(),t.preventDefault())):void this.T()}if(t.preventDefault(),u("client",t,this.M),u("page",t,this.F),this.o.dragImageTranslateOverride)try{var n=!1;if(this.o.dragImageTranslateOverride(t,{x:this.M.x,y:this.M.y},this.p,function(t,i){e._&&(n=!0,e.M.x+=t,e.M.y+=i,e.F.x+=t,e.F.y+=i,l(e._,e.F,e.L,e.P,e.o.dragImageCenterOnTouch))}),n)return}catch(t){}l(this._,this.F,this.L,this.P,this.o.dragImageCenterOnTouch)}},t.prototype.A=function(t){if(!1!==f(t,this.I.identifier)){if(this.o.dragImageTranslateOverride)try{this.o.dragImageTranslateOverride(void 0,void 0,void 0,function(){})}catch(t){}0!==this.v?(t.preventDefault(),this.v="touchcancel"===t.type?3:2):this.T()}},t.prototype.Y=function(){var t=this,i=this.C;this.D.mode=3,this.N.dropEffect=n[0];var s=v("drag",this.u,this.m,this.D,this.N);if(s&&(this.C=n[0]),s||2===this.v||3===this.v)return this.q(this.v)?void function(t,e,i,n){var s=getComputedStyle(t);if("hidden"!==s.visibility&&"none"!==s.display){e.classList.add("dnd-poly-snapback");var o=getComputedStyle(e),r=parseFloat(o.transitionDuration);if(isNaN(r)||0===r)n();else{var h=t.getBoundingClientRect(),a={x:h.left,y:h.top};a.x+=document.body.scrollLeft||document.documentElement.scrollLeft,a.y+=document.body.scrollTop||document.documentElement.scrollTop,a.x-=parseInt(s.marginLeft,10),a.y-=parseInt(s.marginTop,10);var d=parseFloat(o.transitionDelay),f=Math.round(1e3*(r+d));l(e,a,i,void 0,!1),setTimeout(n,f)}}else n()}(this.u,this._,this.L,function(){t.B()}):void this.B();var r=this.o.elementFromPoint(this.M.x,this.M.y),h=this.g;r!==this.p&&r!==this.g&&(this.p=r,null!==this.g&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragexit",this.g,this.m,this.D,this.N,!1)),null===this.p?this.g=this.p:(this.D.mode=3,this.N.dropEffect=g(this.D.effectAllowed,this.u),v("dragenter",this.p,this.m,this.D,this.N)?(this.g=this.p,this.C=m(this.N.effectAllowed,this.N.dropEffect)):this.p!==document.body&&(this.g=document.body))),h!==this.g&&o(h)&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragleave",h,this.m,this.D,this.N,!1,this.g)),o(this.g)&&(this.D.mode=3,this.N.dropEffect=g(this.D.effectAllowed,this.u),!1===v("dragover",this.g,this.m,this.D,this.N)?this.C=n[0]:this.C=m(this.N.effectAllowed,this.N.dropEffect)),i!==this.C&&this._.classList.remove(e+i);var a=e+this.C;this._.classList.add(a)},t.prototype.q=function(t){var e=this.C===n[0]||null===this.g||3===t;return e?o(this.g)&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragleave",this.g,this.m,this.D,this.N,!1)):o(this.g)&&(this.D.mode=1,this.N.dropEffect=this.C,!0===v("drop",this.g,this.m,this.D,this.N)?this.C=this.N.dropEffect:this.C=n[0]),e},t.prototype.B=function(){this.D.mode=3,this.N.dropEffect=this.C,v("dragend",this.u,this.m,this.D,this.N,!1),this.v=2,this.T()},t}(),b={iterationInterval:150,tryFindDraggableTarget:function(t){var e=t.target;do{if(!1!==e.draggable&&e.getAttribute&&"true"===e.getAttribute("draggable"))return e}while((e=e.parentNode)&&e!==document.body)},dragImageSetup:function(t){var e=t.cloneNode(!0);return function t(e,i){if(1===e.nodeType){for(var n=getComputedStyle(e),s=0;s<n.length;s++){var o=n[s];i.style.setProperty(o,n.getPropertyValue(o),n.getPropertyPriority(o))}if(i.style.pointerEvents="none",i.removeAttribute("id"),i.removeAttribute("class"),i.removeAttribute("draggable"),"CANVAS"===i.nodeName){var r=e,h=i,a=r.getContext("2d").getImageData(0,0,r.width,r.height);h.getContext("2d").putImageData(a,0,0)}}if(e.hasChildNodes())for(s=0;s<e.childNodes.length;s++)t(e.childNodes[s],i.childNodes[s])}(t,e),e},elementFromPoint:function(t,e){return document.elementFromPoint(t,e)}};function x(t){if(!y){var e=b.tryFindDraggableTarget(t);if(e)try{y=new D(t,b,e,O)}catch(e){throw O(b,t,3),e}}}function N(t){var e=t.target,i=function(t){s.off(),o.off(),r.off(),clearTimeout(n)},n=window.setTimeout(function(){s.off(),o.off(),r.off(),x(t)},b.holdToDrag),s=a(e,"touchend",i),o=a(e,"touchcancel",i),r=a(window,"scroll",i,!0)}function O(t,e,i){if(0===i&&t.defaultActionOverride)try{t.defaultActionOverride(e),e.defaultPrevented}catch(t){}y=null}t.polyfill=function(t){if(t&&Object.keys(t).forEach(function(e){b[e]=t[e]}),!b.forceApply){var e=(i={dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,userAgentSupportingNativeDnD:void 0},n=!!window.chrome||/chrome/i.test(navigator.userAgent),i.userAgentSupportingNativeDnD=!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||n&&"ontouchstart"in document.documentElement),i);if(e.userAgentSupportingNativeDnD&&e.draggable&&e.dragEvents)return!1}var i,n;return b.holdToDrag?r("touchstart",N,!1):r("touchstart",x,!1),!0},Object.defineProperty(t,"__esModule",{value:!0})});